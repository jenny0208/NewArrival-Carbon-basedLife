<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>云端货架 - GALLERY</title>
    <style>
        body { background: #008080; font-family: "MS Sans Serif", "Courier New", monospace; padding: 20px; }
        h1 { color: white; text-align: center; text-shadow: 2px 2px #000; }
        .shelf {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 20px;
            padding: 20px;
            background: #c0c0c0;
            border: 3px inset #fff;
        }
        .item {
            background: white;
            border: 2px outset #eee;
            padding: 10px;
            text-align: center;
            box-shadow: 5px 5px 0px rgba(0,0,0,0.2);
        }
        .item img { width: 100%; height: auto; border: 1px solid #000; }
        .price { color: red; font-weight: bold; font-size: 1.2em; margin: 5px 0; }
        .barcode { font-family: 'Libre Barcode 39', cursive; font-size: 20px; } /* 模拟条形码 */
        .btn-back { background: #c0c0c0; border: 2px outset #fff; padding: 5px 10px; cursor: pointer; margin-bottom: 10px; }
    </style>
</head>
<body>
    <button class="btn-back" onclick="location.href='/'"> 返回系统 </button>
    <h1> 碳基生命“上架”存档仓库 </h1>
    <div class="shelf" id="shelf">
        <p style="color:#000">正在扫描云端数据库...</p>
    </div>

    <script>
        // 【小白注意】只需要改这里：
        const GITHUB_USER = "Jenny0208"; 
        const GITHUB_REPO = "NewArrival-Carbon-basedLife";

        async function fetchShelf() {
            const shelfDiv = document.getElementById('shelf');
            try {
                const res = await fetch(`https://api.github.com/repos/${GITHUB_USER}/${GITHUB_REPO}/contents/shelf`);
                const data = await res.json();
                
                shelfDiv.innerHTML = '';
                // 筛选图片并按时间倒序
                const images = data.filter(f => f.name.endsWith('.png')).reverse();

                images.forEach(img => {
                    const rawUrl = `https://raw.githubusercontent.com/${GITHUB_USER}/${GITHUB_REPO}/main/${img.path}`;
                    const item = document.createElement('div');
                    item.className = 'item';
                    item.innerHTML = `
                        <img src="${rawUrl}">
                        <div class="price">￥0.50</div>
                        <div style="font-size:10px">ID: ${img.name.split('_')[2]}</div>
                        <div style="letter-spacing: 2px;">|||| ||| || |||</div>
                    `;
                    shelfDiv.appendChild(item);
                });
            } catch (e) {
                shelfDiv.innerHTML = '<p>暂无库存或仓库配置错误。</p>';
            }
        }
        fetchShelf();
    </script>
</body>
</html>
