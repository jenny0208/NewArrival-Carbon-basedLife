<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>RACKED_UP_PROCEDURE.EXE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #008080; font-family: 'SimSun', serif; overflow-x: hidden; }
        .win95-border { box-shadow: inset 2px 2px 0px #fff, inset -2px -2px 0px #808080, 2px 2px 0px #000; background: #c0c0c0; border: 1px solid #000; }
        .blue-header { background: #000080; color: white; padding: 2px 8px; font-weight: bold; font-size: 14px; }
        .neon-title { font-size: 120px; color: #ff00ff; font-weight: 900; text-shadow: 4px 4px #00ffff; line-height: 1; }
        .sub-slogan { background: #ffff00; border: 2px solid #000; padding: 5px 15px; font-weight: bold; transform: translateY(-20px); display: inline-block; }
        .marquee-box { background: #000; color: #0f0; padding: 10px; font-family: monospace; border-y: 2px solid #000; }
        .window-box { width: 500px; height: 600px; display: flex; flex-direction: column; }
        #display-box { background: #000; height: 100%; border: 4px inset #808080; display: flex; items-center; justify-center; position: relative; overflow: hidden; }
        .price-tag { background: #ffff00; color: #f00; border: 2px solid #000; padding: 5px 15px; font-weight: 900; transform: rotate(-10deg); position: absolute; top: 20px; right: 20px; font-size: 32px; z-index: 10; }
    </style>
</head>
<body>
    <div class="flex flex-col items-center mt-10">
        <div class="win95-border w-[800px]">
            <div class="blue-header"><span>RACKED_UP_PROCEDURE.EXE</span><span>[_][X]</span></div>
            <div class="p-10 flex flex-col items-center">
                <h1 class="neon-title">ä¸Š æ¶</h1>
                <div class="sub-slogan">â€œå·®ä¸å¤šå¾—äº†ï¼Œè¿™å°±æŠŠä½ æŒ‚ä¸Šå»ğŸ¤£â€</div>
            </div>
        </div>
    </div>

    <div class="marquee-box mt-6">
        <marquee scrollamount="10">æ£€æµ‹åˆ°æœªæ ‡ä»·ç”Ÿå‘½ä½“... | ç³»ç»Ÿæ­£åœ¨ç›‘è§†ä½ ... | æ‰€æœ‰äººæœ€ç»ˆéƒ½å°†è¢«æ˜ç æ ‡ä»·... | ä¸¥ç¦é€ƒç¦»è´§æ¶...</marquee>
    </div>

    <div class="flex gap-10 justify-center p-10">
        <div class="win95-border window-box">
            <div class="bg-white h-[400px] border-4 inset flex items-center justify-center cursor-pointer" onclick="document.getElementById('fileInput').click()">
                <div id="preview-text">æ‹–å…¥/ç‚¹å‡»ä¸Šä¼ ç…§ç‰‡</div>
                <img id="imgPreview" class="hidden max-h-full">
            </div>
            <input type="file" id="fileInput" class="hidden" onchange="previewImage(this)">
            <div class="bg-black text-[#0f0] p-4 font-mono h-[100px] text-xs">> æ ¸å¿ƒé€»è¾‘å·²åŠ è½½...<br>> å¾…å‘½çŠ¶æ€...</div>
            <button class="bg-[#c0c0c0] border-4 outset p-4 text-2xl font-bold" onclick="startRacking()">æ‰§è¡Œä¸Šæ¶ç¨‹åº [EXE]</button>
        </div>

        <div class="win95-border window-box">
            <div id="display-box">
                <div id="status-text" class="text-[#0f0] font-mono text-center">ğŸ”´ NO_SIGNAL<br>WAITING_FOR_ASSET...</div>
                <div id="price-tag" class="price-tag hidden">ï¿¥0.50</div>
                <img id="finalImg" class="hidden max-h-full">
            </div>
        </div>
    </div>

    <script>
        function previewImage(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = e => {
                    document.getElementById('imgPreview').src = e.target.result;
                    document.getElementById('imgPreview').classList.remove('hidden');
                    document.getElementById('preview-text').classList.add('hidden');
                }
                reader.readAsDataURL(input.files[0]);
            }
        }
        async function startRacking() {
            const file = document.getElementById('fileInput').files[0];
            if (!file) return;
            const status = document.getElementById('status-text');
            status.innerHTML = "ğŸŸ¡ PROCESSING...";
            const fd = new FormData(); fd.append('file', file);
            try {
                const res = await fetch('/upload', { method: 'POST', body: fd });
                const data = await res.json();
                if (data.status === 'success') {
                    status.classList.add('hidden');
                    document.getElementById('finalImg').src = data.url;
                    document.getElementById('finalImg').classList.remove('hidden');
                    document.getElementById('price-tag').classList.remove('hidden');
                } else { status.innerHTML = "ğŸ”´ ERROR: " + data.message; }
            } catch (e) { status.innerHTML = "ğŸ”´ CONNECTION FAILED"; }
        }
    </script>
</body>
</html>
